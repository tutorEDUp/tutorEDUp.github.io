<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>平面圖形(二) 概念模擬器 | 2D Shapes (II) Simulator</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts: Noto Sans TC -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&family=Fredoka:wght@400;600&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Fredoka', 'Noto Sans TC', sans-serif;
            background-color: #f0f9ff;
            /* Prevent bounce scrolling on iOS */
            overscroll-behavior: none;
        }
        
        /* Custom Range Slider Styling */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 28px;
            width: 28px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            margin-top: -12px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 6px;
            cursor: pointer;
            background: #cbd5e1;
            border-radius: 3px;
        }

        /* Shape Animations */
        .shape-transition {
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .active-tab {
            background-color: #3b82f6;
            color: white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .inactive-tab {
            background-color: white;
            color: #64748b;
        }

        /* Corner markers for right angles */
        .right-angle-marker {
            position: absolute;
            width: 16px;
            height: 16px;
            border: 2px solid #ef4444;
            opacity: 0.6;
        }
        .ra-tl { top: 0; left: 0; border-right: none; border-bottom: none; } /* Actually, visual square marker logic is easier with border-bottom and border-right dependent on position */
        
        .corner-box {
            position: absolute;
            width: 20px;
            height: 20px;
            border: 3px solid #ef4444;
            background: transparent;
        }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden text-slate-800">

    <!-- Header / Top Bar -->
    <header class="bg-white shadow-md z-10 flex-none">
        <div class="max-w-6xl mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-4">
                <!-- Logo Placeholder -->
                <div class="h-12 w-12 bg-slate-100 rounded-lg flex items-center justify-center overflow-hidden border border-slate-200">
                    <img src="logo.png" alt="Logo" class="h-full w-full object-contain" onerror="this.style.display='none'; this.parentElement.innerHTML='<i class=\'fa-solid fa-shapes text-blue-500 text-xl\'></i>'">
                </div>
                <div>
                    <h1 class="text-xl md:text-2xl font-bold text-blue-600">
                        <span class="lang-zh">平面圖形 (二)</span>
                        <span class="lang-en hidden">2D Shapes (II)</span>
                    </h1>
                    <p class="text-xs md:text-sm text-slate-500">
                        <span class="lang-zh">概念模擬器</span>
                        <span class="lang-en hidden">Concept Simulator</span>
                    </p>
                </div>
            </div>

            <!-- Language Toggle -->
            <button onclick="toggleLanguage()" class="bg-indigo-100 hover:bg-indigo-200 text-indigo-700 px-4 py-2 rounded-full font-bold transition-colors flex items-center gap-2">
                <i class="fa-solid fa-language"></i>
                <span id="lang-btn-text">English</span>
            </button>
        </div>
    </header>

    <!-- Main Navigation Tabs -->
    <nav class="flex-none bg-slate-50 border-b border-slate-200">
        <div class="max-w-4xl mx-auto flex">
            <button onclick="switchTab('lines')" id="tab-lines" class="flex-1 py-4 text-center font-bold text-lg md:text-xl transition-all active-tab rounded-t-lg mx-2 mt-2">
                <i class="fa-solid fa-bezier-curve mr-2"></i>
                <span class="lang-zh">直線與曲線</span>
                <span class="lang-en hidden">Lines & Curves</span>
            </button>
            <button onclick="switchTab('shapes')" id="tab-shapes" class="flex-1 py-4 text-center font-bold text-lg md:text-xl transition-all inactive-tab rounded-t-lg mx-2 mt-2">
                <i class="fa-regular fa-square mr-2"></i>
                <span class="lang-zh">四邊形特性</span>
                <span class="lang-en hidden">Quadrilaterals</span>
            </button>
        </div>
    </nav>

    <!-- Content Area -->
    <main class="flex-1 overflow-y-auto bg-slate-100 relative">
        
        <!-- SECTION 1: Lines and Curves -->
        <section id="section-lines" class="max-w-4xl mx-auto p-6 h-full flex flex-col">
            
            <div class="bg-white rounded-2xl shadow-lg p-6 flex-1 flex flex-col items-center justify-center relative border border-slate-200">
                
                <h2 class="text-2xl font-bold mb-4 text-center">
                    <span id="line-type-text" class="text-blue-600 transition-all">
                        <span class="lang-zh">直線</span>
                        <span class="lang-en hidden">Straight Line</span>
                    </span>
                </h2>

                <!-- Canvas for drawing -->
                <canvas id="lineCanvas" width="600" height="300" class="w-full max-w-[600px] h-[300px] touch-none cursor-pointer"></canvas>

                <!-- Explanation Box -->
                <div class="mt-6 bg-blue-50 p-4 rounded-xl border-l-4 border-blue-500 w-full max-w-lg">
                    <p class="text-lg text-center" id="line-desc">
                        <span class="lang-zh">這是一條<strong>直線</strong>。它是兩點之間最短的距離，像尺一樣直。</span>
                        <span class="lang-en hidden">This is a <strong>Straight Line</strong>. It is straight like a ruler.</span>
                    </p>
                </div>

                <!-- Controls -->
                <div class="mt-8 w-full max-w-md bg-slate-50 p-6 rounded-xl border border-slate-200">
                    <label class="block text-sm font-bold mb-2 text-slate-600">
                        <span class="lang-zh">調整彎曲程度</span>
                        <span class="lang-en hidden">Adjust Curvature</span>
                    </label>
                    <input type="range" id="curveSlider" min="0" max="100" value="0" class="w-full">
                    <div class="flex justify-between text-xs text-slate-400 mt-2 font-bold uppercase">
                        <span>
                            <span class="lang-zh">直</span>
                            <span class="lang-en hidden">Straight</span>
                        </span>
                        <span>
                            <span class="lang-zh">彎</span>
                            <span class="lang-en hidden">Curved</span>
                        </span>
                    </div>
                </div>

                <div class="absolute top-4 right-4 bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-bold shadow-sm">
                    <i class="fa-regular fa-lightbulb mr-1"></i>
                    <span class="lang-zh">試著拖動滑桿！</span>
                    <span class="lang-en hidden">Try the slider!</span>
                </div>
            </div>
        </section>

        <!-- SECTION 2: Shapes (Quadrilaterals) -->
        <section id="section-shapes" class="max-w-4xl mx-auto p-6 h-full flex-col hidden">
            
            <div class="grid md:grid-cols-2 gap-6 h-full">
                
                <!-- Visualization Panel -->
                <div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col items-center justify-center relative border border-slate-200 order-2 md:order-1">
                    
                    <div class="absolute top-4 left-4 text-xl font-bold text-slate-400">
                        <span class="lang-zh">四邊形</span><span class="lang-en hidden">Quadrilateral</span>
                    </div>

                    <!-- The Shape -->
                    <div class="relative flex items-center justify-center w-full h-[300px]">
                        <div id="dynamicShape" class="bg-orange-400 border-4 border-orange-600 shape-transition relative shadow-xl" style="width: 200px; height: 150px;">
                            
                            <!-- Right Angle Markers -->
                            <div class="corner-box absolute top-0 left-0 border-r-0 border-b-0 border-orange-800 opacity-50"></div>
                            <div class="corner-box absolute top-0 right-0 border-l-0 border-b-0 border-orange-800 opacity-50"></div>
                            <div class="corner-box absolute bottom-0 left-0 border-r-0 border-t-0 border-orange-800 opacity-50"></div>
                            <div class="corner-box absolute bottom-0 right-0 border-l-0 border-t-0 border-orange-800 opacity-50"></div>

                            <!-- Side Labels -->
                            <div class="absolute -top-8 w-full text-center font-bold text-orange-600"><span id="width-display">Width</span></div>
                            <div class="absolute -right-12 h-full flex items-center font-bold text-orange-600"><span id="height-display" class="transform rotate-90">Height</span></div>
                        
                            <!-- Equal Side Markers (Ticks) -->
                            <div class="absolute top-0 left-1/2 w-[2px] h-[10px] bg-black -translate-x-1/2 -translate-y-1/2" id="tick-top"></div>
                            <div class="absolute bottom-0 left-1/2 w-[2px] h-[10px] bg-black -translate-x-1/2 translate-y-1/2" id="tick-bottom"></div>
                            <div class="absolute left-0 top-1/2 w-[10px] h-[2px] bg-black -translate-x-1/2 -translate-y-1/2" id="tick-left"></div>
                            <div class="absolute right-0 top-1/2 w-[10px] h-[2px] bg-black translate-x-1/2 -translate-y-1/2" id="tick-right"></div>
                        </div>
                    </div>

                    <!-- Result Label -->
                    <div id="shape-result" class="mt-8 px-6 py-3 bg-green-100 text-green-800 rounded-full font-bold text-xl shadow-sm transition-colors duration-300">
                        <!-- JS populates this -->
                    </div>
                </div>

                <!-- Controls & Info Panel -->
                <div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col justify-between border border-slate-200 order-1 md:order-2">
                    
                    <div>
                        <h2 class="text-2xl font-bold mb-6 text-slate-700">
                            <i class="fa-solid fa-sliders text-blue-500 mr-2"></i>
                            <span class="lang-zh">形狀實驗室</span>
                            <span class="lang-en hidden">Shape Lab</span>
                        </h2>

                        <!-- Width Control -->
                        <div class="mb-6">
                            <label class="flex justify-between mb-2 font-bold text-slate-600">
                                <span>
                                    <span class="lang-zh">寬度 (Width)</span>
                                    <span class="lang-en hidden">Width</span>
                                </span>
                                <span class="bg-slate-200 px-2 rounded text-sm" id="val-w">200</span>
                            </label>
                            <input type="range" id="widthSlider" min="100" max="280" value="200" step="10">
                        </div>

                        <!-- Height Control -->
                        <div class="mb-6">
                            <label class="flex justify-between mb-2 font-bold text-slate-600">
                                <span>
                                    <span class="lang-zh">高度 (Height)</span>
                                    <span class="lang-en hidden">Height</span>
                                </span>
                                <span class="bg-slate-200 px-2 rounded text-sm" id="val-h">150</span>
                            </label>
                            <input type="range" id="heightSlider" min="100" max="280" value="150" step="10">
                        </div>

                        <!-- Buttons to auto-set -->
                        <div class="flex gap-2 mb-6">
                            <button onclick="setShape(200, 200)" class="flex-1 bg-purple-100 hover:bg-purple-200 text-purple-700 py-2 rounded-lg font-bold transition">
                                <span class="lang-zh">變正方形</span>
                                <span class="lang-en hidden">Make Square</span>
                            </button>
                            <button onclick="setShape(250, 150)" class="flex-1 bg-orange-100 hover:bg-orange-200 text-orange-700 py-2 rounded-lg font-bold transition">
                                <span class="lang-zh">變長方形</span>
                                <span class="lang-en hidden">Make Rectangle</span>
                            </button>
                        </div>
                    </div>

                    <!-- Property Checklist -->
                    <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
                        <h3 class="font-bold text-slate-500 mb-2 uppercase text-xs tracking-wider">
                            <span class="lang-zh">特性檢查</span>
                            <span class="lang-en hidden">Properties Check</span>
                        </h3>
                        <ul class="space-y-2 text-sm md:text-base">
                            <li class="flex items-center gap-2">
                                <i class="fa-solid fa-check-circle text-green-500"></i>
                                <span>
                                    <span class="lang-zh">有四條直線邊</span>
                                    <span class="lang-en hidden">Has 4 straight sides</span>
                                </span>
                            </li>
                            <li class="flex items-center gap-2">
                                <i class="fa-solid fa-check-circle text-green-500"></i>
                                <span>
                                    <span class="lang-zh">有四個直角</span>
                                    <span class="lang-en hidden">Has 4 right angles</span>
                                </span>
                            </li>
                            <li id="prop-equal" class="flex items-center gap-2 transition-all opacity-50">
                                <i id="icon-equal" class="fa-solid fa-circle text-slate-300"></i>
                                <span class="font-bold">
                                    <span class="lang-zh">四條邊長度相等</span>
                                    <span class="lang-en hidden">All 4 sides are equal</span>
                                </span>
                            </li>
                            <li id="prop-opposite" class="flex items-center gap-2 transition-all text-green-700">
                                <i class="fa-solid fa-check-circle text-green-500"></i>
                                <span>
                                    <span class="lang-zh">對邊長度相等</span>
                                    <span class="lang-en hidden">Opposite sides are equal</span>
                                </span>
                            </li>
                        </ul>
                    </div>

                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-slate-800 text-slate-300 py-2 text-center text-xs flex-none">
        <p>&copy; 2026 Math Concepts Sim. 
            <span class="lang-zh">適用於 iPad 與 筆記型電腦</span>
            <span class="lang-en hidden">Optimized for iPad & Notebook</span>
        </p>
    </footer>

    <script>
        // --- State Management ---
        let lang = 'zh'; // 'zh' or 'en'
        const tabs = {
            lines: document.getElementById('section-lines'),
            shapes: document.getElementById('section-shapes')
        };
        const tabBtns = {
            lines: document.getElementById('tab-lines'),
            shapes: document.getElementById('tab-shapes')
        };

        // --- Bilingual Logic ---
        function toggleLanguage() {
            lang = lang === 'zh' ? 'en' : 'zh';
            document.getElementById('lang-btn-text').innerText = lang === 'zh' ? 'English' : '中文';
            
            // Toggle all language spans
            document.querySelectorAll('.lang-zh').forEach(el => el.classList.toggle('hidden', lang !== 'zh'));
            document.querySelectorAll('.lang-en').forEach(el => el.classList.toggle('hidden', lang !== 'en'));
            
            // Re-render dynamic content
            updateShapeAnalysis();
            updateLineText();
        }

        // --- Tab Navigation ---
        function switchTab(tabName) {
            // Hide all sections
            Object.values(tabs).forEach(el => el.classList.add('hidden'));
            // Remove active style from buttons
            Object.values(tabBtns).forEach(el => {
                el.classList.remove('active-tab');
                el.classList.add('inactive-tab');
            });

            // Show selected
            tabs[tabName].classList.remove('hidden');
            tabs[tabName].classList.add('flex'); // Add flex back
            
            // Style active button
            tabBtns[tabName].classList.remove('inactive-tab');
            tabBtns[tabName].classList.add('active-tab');

            // Trigger resize for canvas if needed
            if(tabName === 'lines') drawLine();
        }

        // --- Module 1: Lines & Curves Logic ---
        const canvas = document.getElementById('lineCanvas');
        const ctx = canvas.getContext('2d');
        const curveSlider = document.getElementById('curveSlider');
        
        // Handle resizing canvas resolution for crisp lines on Retina/HiDPI screens
        function resizeCanvas() {
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * 2;
            canvas.height = rect.height * 2;
            ctx.scale(2, 2);
            drawLine();
        }
        window.addEventListener('resize', resizeCanvas);

        function drawLine() {
            const width = canvas.width / 2;
            const height = canvas.height / 2;
            const curveValue = parseInt(curveSlider.value);
            
            ctx.clearRect(0, 0, width, height);
            
            // Points
            const startX = 50;
            const startY = height / 2;
            const endX = width - 50;
            const endY = height / 2;

            // Control Point logic
            // If slider is 0, control point is on the line. If 100, it's high up.
            // Using Quadratic Bezier Curve
            const controlY = startY - (curveValue * 2); 
            const controlX = width / 2;

            ctx.beginPath();
            ctx.moveTo(startX, startY);
            
            if (curveValue === 0) {
                ctx.lineTo(endX, endY);
                ctx.strokeStyle = '#3b82f6'; // Blue for straight
            } else {
                ctx.quadraticCurveTo(controlX, controlY, endX, endY);
                // Gradient color shift based on curvature
                ctx.strokeStyle = curveValue > 50 ? '#ec4899' : '#8b5cf6'; // Pink/Purple for curve
            }
            
            ctx.lineWidth = 6;
            ctx.lineCap = 'round';
            ctx.stroke();

            // Draw Dots at ends
            ctx.fillStyle = '#1e293b';
            ctx.beginPath(); ctx.arc(startX, startY, 6, 0, Math.PI*2); ctx.fill();
            ctx.beginPath(); ctx.arc(endX, endY, 6, 0, Math.PI*2); ctx.fill();

            // Update Text
            updateLineText();
        }

        function updateLineText() {
            const val = parseInt(curveSlider.value);
            const titleEl = document.getElementById('line-type-text');
            const descEl = document.getElementById('line-desc');

            if (val === 0) {
                titleEl.className = "text-blue-600 transition-all";
                if(lang === 'zh') {
                    titleEl.innerText = "直線";
                    descEl.innerHTML = "這是一條<strong>直線</strong>。它是兩點之間最短的距離，像尺一樣直。";
                } else {
                    titleEl.innerText = "Straight Line";
                    descEl.innerHTML = "This is a <strong>Straight Line</strong>. It is straight like a ruler.";
                }
            } else {
                titleEl.className = "text-pink-600 transition-all";
                if(lang === 'zh') {
                    titleEl.innerText = "曲線";
                    descEl.innerHTML = "這是一條<strong>曲線</strong>。它像蛇一樣彎彎曲曲的。";
                } else {
                    titleEl.innerText = "Curved Line";
                    descEl.innerHTML = "This is a <strong>Curved Line</strong>. It bends like a snake or a rainbow.";
                }
            }
        }

        curveSlider.addEventListener('input', drawLine);
        // Initial draw
        setTimeout(resizeCanvas, 100);


        // --- Module 2: Shape Lab Logic ---
        const widthSlider = document.getElementById('widthSlider');
        const heightSlider = document.getElementById('heightSlider');
        const shape = document.getElementById('dynamicShape');
        const valW = document.getElementById('val-w');
        const valH = document.getElementById('val-h');
        
        function updateShape() {
            const w = parseInt(widthSlider.value);
            const h = parseInt(heightSlider.value);
            
            // Update visual size
            shape.style.width = w + 'px';
            shape.style.height = h + 'px';
            
            // Update text numbers
            valW.innerText = w;
            valH.innerText = h;

            // Handle labels positioning
            const widthDisplay = document.getElementById('width-display');
            const heightDisplay = document.getElementById('height-display');
            widthDisplay.innerText = w;
            heightDisplay.innerText = h;

            // Analyze Shape
            updateShapeAnalysis();
        }

        function updateShapeAnalysis() {
            const w = parseInt(widthSlider.value);
            const h = parseInt(heightSlider.value);
            const isSquare = (w === h);

            const resultBox = document.getElementById('shape-result');
            const propEqual = document.getElementById('prop-equal');
            const iconEqual = document.getElementById('icon-equal');
            const propOpposite = document.getElementById('prop-opposite');

            // Visual Ticks logic
            const tickTop = document.getElementById('tick-top');
            const tickRight = document.getElementById('tick-right');
            // If square, all ticks are single. If rectangle, Top/Bottom single, Left/Right double (simulated by logic or color)
            // For simplicity in this kid app:
            // Square: All ticks same color/style.
            // Rectangle: Top/Bottom one style, Left/Right another.
            
            if (isSquare) {
                // UI Feedback for Square
                shape.className = "bg-purple-400 border-4 border-purple-600 shape-transition relative shadow-xl mx-auto";
                resultBox.className = "mt-8 px-6 py-3 bg-purple-100 text-purple-800 rounded-full font-bold text-xl shadow-sm transition-colors duration-300 text-center";
                
                if (lang === 'zh') {
                    resultBox.innerHTML = "<i class='fa-solid fa-star mr-2'></i> 這是 <strong>正方形 (Square)</strong>";
                } else {
                    resultBox.innerHTML = "<i class='fa-solid fa-star mr-2'></i> It is a <strong>Square</strong>";
                }

                // Property Checklist Update
                propEqual.className = "flex items-center gap-2 transition-all text-purple-700 font-bold";
                propEqual.style.opacity = "1";
                iconEqual.className = "fa-solid fa-check-circle text-green-500";
                
                // Ticks (Make them look unified)
                tickTop.style.height = "10px"; tickRight.style.width = "10px";
                
            } else {
                // UI Feedback for Rectangle
                shape.className = "bg-orange-400 border-4 border-orange-600 shape-transition relative shadow-xl mx-auto";
                resultBox.className = "mt-8 px-6 py-3 bg-orange-100 text-orange-800 rounded-full font-bold text-xl shadow-sm transition-colors duration-300 text-center";

                if (lang === 'zh') {
                    resultBox.innerHTML = "這是 <strong>長方形 (Rectangle)</strong>";
                } else {
                    resultBox.innerHTML = "It is a <strong>Rectangle</strong>";
                }

                // Property Checklist Update
                propEqual.className = "flex items-center gap-2 transition-all text-slate-400";
                propEqual.style.opacity = "0.5";
                iconEqual.className = "fa-solid fa-circle text-slate-300";

                // Visual difference in ticks (Simulating geometry notation)
                // We keep top/bottom simple, make left/right double? 
                // CSS limitation in single file without pseudo-elements complexity, 
                // so we just keep them black. The text explains it.
            }
        }

        function setShape(w, h) {
            widthSlider.value = w;
            heightSlider.value = h;
            updateShape();
        }

        widthSlider.addEventListener('input', updateShape);
        heightSlider.addEventListener('input', updateShape);

        // Initialize
        updateShape();

    </script>
</body>
</html>
